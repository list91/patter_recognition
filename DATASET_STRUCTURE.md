# –°–¢–†–£–ö–¢–£–†–ê –î–ê–¢–ê–°–ï–¢–ê: –ß–¢–û –ì–î–ï –õ–ï–ñ–ò–¢

## –ö–û–ù–§–ò–ì–£–†–ê–¶–ò–Ø (data.yaml)

```yaml
path: ./data
train: images/train     # –ü–∞–ø–∫–∞ –¥–ª—è –æ–±—É—á–µ–Ω–∏—è
val: images/train       # ‚ö†Ô∏è –¢–ê –ñ–ï –ø–∞–ø–∫–∞ –¥–ª—è –≤–∞–ª–∏–¥–∞—Ü–∏–∏!
nc: 1                   # 1 –∫–ª–∞—Å—Å
names: ['switch']       # –ù–∞–∑–≤–∞–Ω–∏–µ –∫–ª–∞—Å—Å–∞
```

**‚ö†Ô∏è –ü–†–û–ë–õ–ï–ú–ê:** `train` –∏ `val` —É–∫–∞–∑—ã–≤–∞—é—Ç –Ω–∞ –û–î–ù–£ –ò –¢–£ –ñ–ï –ø–∞–ø–∫—É!

---

## –¢–ï–ö–£–©–ò–ï –î–ê–ù–ù–´–ï

### üìÅ –û–ë–£–ß–ï–ù–ò–ï (Training)

**–ü—É—Ç—å:** `data/images/train/`

```
train_01.jpg          ‚Üê –ï–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω–æ–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –¥–ª—è –æ–±—É—á–µ–Ω–∏—è!
```

**–†–∞–∑–º–µ—Ä:** 4963√ó3509 –ø–∏–∫—Å–µ–ª–µ–π
**–†–∞–∑–º–µ—Ç–∫–∞:** `data/labels/train/train_01.txt`
**–û–±—ä–µ–∫—Ç–æ–≤:** 12 –æ–±—ä–µ–∫—Ç–æ–≤ –∫–ª–∞—Å—Å–∞ 0 (switch)
**–†–∞–∑–º–µ—Ä –æ–±—ä–µ–∫—Ç–æ–≤:** ~22√ó47 –ø–∏–∫—Å–µ–ª–µ–π –∫–∞–∂–¥—ã–π

**–°–æ–¥–µ—Ä–∂–∏–º–æ–µ —Ä–∞–∑–º–µ—Ç–∫–∏ (train_01.txt):**
```
0 0.137820 0.380023 0.004433 0.013394
0 0.179529 0.380023 0.004433 0.013394
0 0.262744 0.379738 0.004433 0.013394
... (–≤—Å–µ–≥–æ 12 —Å—Ç—Ä–æ–∫)
```

---

### üìä –í–ê–õ–ò–î–ê–¶–ò–Ø (Validation)

**–ü—É—Ç—å:** `images/train/` (‚ö†Ô∏è —Ç–∞ –∂–µ —á—Ç–æ –∏ train!)

```
train_01.jpg          ‚Üê –¢–æ –∂–µ —Å–∞–º–æ–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ!
```

**‚ö†Ô∏è –ü–†–û–ë–õ–ï–ú–ê:** –ú–æ–¥–µ–ª—å –≤–∞–ª–∏–¥–∏—Ä—É–µ—Ç—Å—è –Ω–∞ –¢–ï–• –ñ–ï –¥–∞–Ω–Ω—ã—Ö, –Ω–∞ –∫–æ—Ç–æ—Ä—ã—Ö –æ–±—É—á–∞–µ—Ç—Å—è!

**–ü–æ—Å–ª–µ–¥—Å—Ç–≤–∏—è:**
- –ù–µ–≤–æ–∑–º–æ–∂–Ω–æ –æ—Ü–µ–Ω–∏—Ç—å —Ä–µ–∞–ª—å–Ω–æ–µ –∫–∞—á–µ—Å—Ç–≤–æ –º–æ–¥–µ–ª–∏
- –ú–µ—Ç—Ä–∏–∫–∏ –Ω–µ –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç –ø–µ—Ä–µ–æ–±—É—á–µ–Ω–∏–µ
- val_loss —Ä–∞—Å—Ç—ë—Ç ‚Üí extreme overfitting

---

### üß™ –¢–ï–°–¢–ò–†–û–í–ê–ù–ò–ï (Test)

**–ü—É—Ç—å:** `data/images/test/`

```
test_01.jpg           ‚Üê 4 —Ç–µ—Å—Ç–æ–≤—ã—Ö –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è
test_02.jpg
test_03.jpg
test_04.jpg
train_01.jpg          ‚Üê –ö–æ–ø–∏—è —Ç—Ä–µ–Ω–∏—Ä–æ–≤–æ—á–Ω–æ–≥–æ (–∑–∞—á–µ–º?)
```

**‚ö†Ô∏è –ü–†–û–ë–õ–ï–ú–ê:** –î–ª—è test_*.jpg –ù–ï–¢ —Ä–∞–∑–º–µ—Ç–∫–∏ (–Ω–µ—Ç test_01.txt –∏ —Ç.–¥.)

**–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ:** –¢–æ–ª—å–∫–æ –¥–ª—è —Ä—É—á–Ω–æ–≥–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –ø–æ—Å–ª–µ –æ–±—É—á–µ–Ω–∏—è (–≤ train_and_test_confidence.py —Ç–µ—Å—Ç–∏—Ä—É–µ–º –Ω–∞ train_01.jpg)

---

## –ß–¢–û –ü–†–û–ò–°–•–û–î–ò–¢ –í–û –í–†–ï–ú–Ø –û–ë–£–ß–ï–ù–ò–Ø

### –≠–ø–æ—Ö–∞ –æ–±—É—á–µ–Ω–∏—è:

```
1. TRAIN —Ñ–∞–∑–∞:
   - –ß–∏—Ç–∞–µ—Ç: data/images/train/train_01.jpg
   - –†–∞–∑–º–µ—Ç–∫–∞: data/labels/train/train_01.txt (12 –æ–±—ä–µ–∫—Ç–æ–≤)
   - –ü—Ä–∏–º–µ–Ω—è–µ—Ç –∞—É–≥–º–µ–Ω—Ç–∞—Ü–∏–∏ (mosaic=1.0 ‚Üê –ü–†–û–ë–õ–ï–ú–ê!)
   - –í—ã—á–∏—Å–ª—è–µ—Ç train_loss

2. VALIDATION —Ñ–∞–∑–∞:
   - –ß–∏—Ç–∞–µ—Ç: data/images/train/train_01.jpg (–¢–û –ñ–ï!)
   - –†–∞–∑–º–µ—Ç–∫–∞: data/labels/train/train_01.txt (–¢–ê –ñ–ï!)
   - –ë–ï–ó –∞—É–≥–º–µ–Ω—Ç–∞—Ü–∏–π
   - –í—ã—á–∏—Å–ª—è–µ—Ç val_loss, mAP, precision, recall

3. –†–ï–ó–£–õ–¨–¢–ê–¢:
   - train_loss –∏ val_loss —Å—á–∏—Ç–∞—é—Ç—Å—è –Ω–∞ –û–î–ù–û–ú –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–∏
   - –ú–æ–¥–µ–ª—å "–∑–∞–ø–æ–º–∏–Ω–∞–µ—Ç" –µ–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω–æ–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ
   - val_loss = 76 (extreme overfitting!)
```

---

## –ü–†–û–ë–õ–ï–ú–´ –¢–ï–ö–£–©–ï–ô –°–¢–†–£–ö–¢–£–†–´

### üî¥ –ö–†–ò–¢–ò–ß–ù–ê–Ø #1: 1 –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –¥–ª—è –æ–±—É—á–µ–Ω–∏—è
```
–ü—Ä–æ–±–ª–µ–º–∞: train_01.jpg - –µ–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω–æ–µ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–æ—á–Ω–æ–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ
–ü–æ—Å–ª–µ–¥—Å—Ç–≤–∏—è:
  - –ú–æ–¥–µ–ª—å –ø–µ—Ä–µ–æ–±—É—á–∞–µ—Ç—Å—è –Ω–∞ 1 –æ–±—Ä–∞–∑–µ—Ü
  - –ù–µ—Ç –≤–∞—Ä–∏–∞—Ç–∏–≤–Ω–æ—Å—Ç–∏
  - –ù–µ –º–æ–∂–µ—Ç –æ–±–æ–±—â–∏—Ç—å –ø–∞—Ç—Ç–µ—Ä–Ω—ã
–†–µ—à–µ–Ω–∏–µ: –ù—É–∂–Ω–æ –º–∏–Ω–∏–º—É–º 50-100 –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π
```

### üî¥ –ö–†–ò–¢–ò–ß–ù–ê–Ø #2: train = val
```
–ü—Ä–æ–±–ª–µ–º–∞: –í–∞–ª–∏–¥–∞—Ü–∏—è –Ω–∞ —Ç–µ—Ö –∂–µ –¥–∞–Ω–Ω—ã—Ö —á—Ç–æ –∏ –æ–±—É—á–µ–Ω–∏–µ
–ü–æ—Å–ª–µ–¥—Å—Ç–≤–∏—è:
  - val_loss –Ω–µ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç —Ä–µ–∞–ª—å–Ω–æ–µ –∫–∞—á–µ—Å—Ç–≤–æ
  - –ù–µ–≤–æ–∑–º–æ–∂–Ω–æ –æ—Ç—Å–ª–µ–¥–∏—Ç—å –ø–µ—Ä–µ–æ–±—É—á–µ–Ω–∏–µ
  - –ú–µ—Ç—Ä–∏–∫–∏ –±–µ—Å—Å–º—ã—Å–ª–µ–Ω–Ω—ã
–†–µ—à–µ–Ω–∏–µ: –†–∞–∑–¥–µ–ª–∏—Ç—å –¥–∞–Ω–Ω—ã–µ 80/20 (train/val)
```

### üü† –í–ê–ñ–ù–ê–Ø #3: –ù–µ—Ç —Ä–∞–∑–º–µ—Ç–∫–∏ –¥–ª—è test
```
–ü—Ä–æ–±–ª–µ–º–∞: test_01.jpg...test_04.jpg –±–µ–∑ .txt —Ñ–∞–π–ª–æ–≤
–ü–æ—Å–ª–µ–¥—Å—Ç–≤–∏—è:
  - –ù–µ–ª—å–∑—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ—Ü–µ–Ω–∏—Ç—å –∫–∞—á–µ—Å—Ç–≤–æ
  - –¢–æ–ª—å–∫–æ –≤–∏–∑—É–∞–ª—å–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞
–†–µ—à–µ–Ω–∏–µ: –†–∞–∑–º–µ—Ç–∏—Ç—å —Ç–µ—Å—Ç–æ–≤—ã–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è
```

### üü° –°–†–ï–î–ù–Ø–Ø #4: –î—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ train_01.jpg –≤ test
```
–ü—Ä–æ–±–ª–µ–º–∞: train_01.jpg –µ—Å—Ç—å –∏ –≤ train/ –∏ –≤ test/
–ü–æ—Å–ª–µ–¥—Å—Ç–≤–∏—è: –ü—É—Ç–∞–Ω–∏—Ü–∞
–†–µ—à–µ–Ω–∏–µ: –£–¥–∞–ª–∏—Ç—å –∏–∑ test/
```

---

## –ö–ê–ö –î–û–õ–ñ–ù–ê –í–´–ì–õ–Ø–î–ï–¢–¨ –ü–†–ê–í–ò–õ–¨–ù–ê–Ø –°–¢–†–£–ö–¢–£–†–ê

### –í–∞—Ä–∏–∞–Ω—Ç A: –ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è (–µ—Å–ª–∏ –Ω–µ—Ç –±–æ–ª—å—à–µ –¥–∞–Ω–Ω—ã—Ö)

**–û—Å—Ç–∞–≤–ª—è–µ–º –∫–∞–∫ –µ—Å—Ç—å, –ù–û:**
1. –û—Ç–∫–ª—é—á–∞–µ–º mosaic (–æ–±—ä–µ–∫—Ç—ã —Å–ª–∏—à–∫–æ–º –º–µ–ª–∫–∏–µ)
2. –ü–æ–Ω–∏–º–∞–µ–º —á—Ç–æ –º–µ—Ç—Ä–∏–∫–∏ –±–µ—Å—Å–º—ã—Å–ª–µ–Ω–Ω—ã
3. –û—Ü–µ–Ω–∏–≤–∞–µ–º –∫–∞—á–µ—Å—Ç–≤–æ –≤–∏–∑—É–∞–ª—å–Ω–æ

### –í–∞—Ä–∏–∞–Ω—Ç B: –°–æ–∑–¥–∞—Ç—å –±–æ–ª—å—à–µ –¥–∞–Ω–Ω—ã—Ö –∏–∑ —Ç–æ–≥–æ —á—Ç–æ –µ—Å—Ç—å

**Crops –∏–∑ train_01.jpg:**
```
train_01.jpg (4963√ó3509, 12 –æ–±—ä–µ–∫—Ç–æ–≤)
    ‚Üì –≤—ã—Ä–µ–∑–∞—Ç—å 800√ó800 crops –≤–æ–∫—Ä—É–≥ –∫–∞–∂–¥–æ–≥–æ –æ–±—ä–µ–∫—Ç–∞
12 crops (800√ó800 –∫–∞–∂–¥—ã–π, 1 –æ–±—ä–µ–∫—Ç)
    ‚Üì —Ä–∞–∑–¥–µ–ª–∏—Ç—å 80/20
9-10 crops ‚Üí train/
2-3 crops  ‚Üí val/
```

**–ù–æ–≤–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞:**
```
data/
‚îú‚îÄ‚îÄ images/
‚îÇ   ‚îú‚îÄ‚îÄ train/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ crop_00.jpg
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ crop_01.jpg
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ ...
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ crop_09.jpg  (10 crops)
‚îÇ   ‚îî‚îÄ‚îÄ val/
‚îÇ       ‚îú‚îÄ‚îÄ crop_10.jpg
‚îÇ       ‚îî‚îÄ‚îÄ crop_11.jpg  (2 crops)
‚îî‚îÄ‚îÄ labels/
    ‚îú‚îÄ‚îÄ train/
    ‚îÇ   ‚îú‚îÄ‚îÄ crop_00.txt  (1 –æ–±—ä–µ–∫—Ç –≤ –∫–∞–∂–¥–æ–º)
    ‚îÇ   ‚îî‚îÄ‚îÄ ...
    ‚îî‚îÄ‚îÄ val/
        ‚îú‚îÄ‚îÄ crop_10.txt
        ‚îî‚îÄ‚îÄ crop_11.txt
```

**data.yaml:**
```yaml
path: ./data
train: images/train    # –¢–µ–ø–µ—Ä—å 10 –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π
val: images/val        # –û—Ç–¥–µ–ª—å–Ω–∞—è –ø–∞–ø–∫–∞!
nc: 1
names: ['switch']
```

### –í–∞—Ä–∏–∞–Ω—Ç C: –°–æ–±—Ä–∞—Ç—å –±–æ–ª—å—à–µ –¥–∞–Ω–Ω—ã—Ö (–ü–†–ê–í–ò–õ–¨–ù–û)

**–ù—É–∂–Ω–æ:**
- –ú–∏–Ω–∏–º—É–º 50-100 —Å—Ö–µ–º
- 500-1000 —Ä–∞–∑–º–µ—á–µ–Ω–Ω—ã—Ö –æ–±—ä–µ–∫—Ç–æ–≤
- Split 80/10/10 (train/val/test)

---

## –¢–ï–ö–£–©–ê–Ø –°–ò–¢–£–ê–¶–ò–Ø –° –û–ë–£–ß–ï–ù–ò–ï–ú

### –ß—Ç–æ –≤–∏–¥–∏—Ç –º–æ–¥–µ–ª—å –≤–æ –≤—Ä–µ–º—è —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏:

**–≠–ø–æ—Ö–∞ 1:**
```
TRAIN: train_01.jpg —Å mosaic ‚Üí –æ–±—ä–µ–∫—Ç—ã 4px
VAL:   train_01.jpg –±–µ–∑ mosaic ‚Üí –æ–±—ä–µ–∫—Ç—ã 8.5px
Loss: cls=33, box=2
```

**–≠–ø–æ—Ö–∞ 15:**
```
TRAIN: train_01.jpg —Å mosaic ‚Üí –æ–±—ä–µ–∫—Ç—ã 4px (–Ω–µ–≤–∏–¥–∏–º—ã)
VAL:   train_01.jpg –±–µ–∑ mosaic ‚Üí –æ–±—ä–µ–∫—Ç—ã 8.5px (–µ–¥–≤–∞ –≤–∏–¥–∏–º—ã)
Loss: cls=41‚Üë, box=5.6‚Üë (–†–ê–°–¢–£–¢!)
```

**–í—ã–≤–æ–¥:** –ú–æ–¥–µ–ª—å –ø—ã—Ç–∞–µ—Ç—Å—è –≤—ã—É—á–∏—Ç—å –Ω–µ–≤–æ–∑–º–æ–∂–Ω–æ–µ (–æ–±—ä–µ–∫—Ç—ã –Ω–µ–≤–∏–¥–∏–º—ã –ø–æ—Å–ª–µ mosaic)

---

## –ß–¢–û –¢–ï–°–¢–ò–†–£–ï–¢ train_and_test_confidence.py

–ü–æ—Å–ª–µ –æ–±—É—á–µ–Ω–∏—è —Å–∫—Ä–∏–ø—Ç:
```python
1. –ó–∞–≥—Ä—É–∂–∞–µ—Ç –º–æ–¥–µ–ª—å: runs/detect/quick_train/weights/best.pt
2. –¢–µ—Å—Ç–∏—Ä—É–µ—Ç –Ω–∞: data/images/train/train_01.jpg
3. –í—ã–¥–∞—ë—Ç —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É confidence
4. –°–æ—Ö—Ä–∞–Ω—è–µ—Ç –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—é: results/train_prediction.jpg
```

**‚ö†Ô∏è –ü—Ä–æ–±–ª–µ–º–∞:** –¢–µ—Å—Ç–∏—Ä—É–µ–º –Ω–∞ —Ç–æ–º –∂–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–∏, –Ω–∞ –∫–æ—Ç–æ—Ä–æ–º —É—á–∏–ª–∏—Å—å!

---

## –ò–¢–û–ì–û

### –¢–µ–∫—É—â–∞—è —Å–∏—Ç—É–∞—Ü–∏—è:
```
–û–ë–£–ß–ï–ù–ò–ï:  1 –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ (train_01.jpg), 12 –æ–±—ä–µ–∫—Ç–æ–≤
–í–ê–õ–ò–î–ê–¶–ò–Ø: –¢–û –ñ–ï –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ (train_01.jpg)
–¢–ï–°–¢:      –¢–û –ñ–ï –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ (train_01.jpg) + 4 –±–µ–∑ —Ä–∞–∑–º–µ—Ç–∫–∏

–ü—Ä–æ–±–ª–µ–º—ã:
1. Mosaic —É–º–µ–Ω—å—à–∞–µ—Ç –æ–±—ä–µ–∫—Ç—ã 8.5px ‚Üí 4.3px
2. –ù–µ—Ç —Ä–∞–∑–¥–µ–ª–µ–Ω–∏—è train/val
3. 1 –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ = extreme overfitting
4. –ú–µ—Ç—Ä–∏–∫–∏ –±–µ—Å—Å–º—ã—Å–ª–µ–Ω–Ω—ã
```

### –ü–æ—á–µ–º—É –º–æ–¥–µ–ª—å –Ω–µ —É—á–∏—Ç—Å—è:
1. **–ì–ª–∞–≤–Ω–æ–µ:** Mosaic –¥–µ–ª–∞–µ—Ç –æ–±—ä–µ–∫—Ç—ã –Ω–µ–≤–∏–¥–∏–º—ã–º–∏ (4px)
2. –ü–æ—Å–ª–µ –æ—Ç–∫–ª—é—á–µ–Ω–∏—è mosaic: –æ–±—ä–µ–∫—Ç—ã 8.5px (–Ω–∞ –≥—Ä–∞–Ω–∏ –≤–∏–¥–∏–º–æ—Å—Ç–∏)
3. 1 –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ ‚Üí –ø–µ—Ä–µ–æ–±—É—á–µ–Ω–∏–µ
4. train=val ‚Üí –Ω–µ—Ç –∫–æ–Ω—Ç—Ä–æ–ª—è –∫–∞—á–µ—Å—Ç–≤–∞

---

## –†–ï–ö–û–ú–ï–ù–î–ê–¶–ò–ò

**–°–ï–ô–ß–ê–° (–±—ã—Å—Ç—Ä–æ):**
1. –û—Ç–∫–ª—é—á–∏—Ç—å mosaic (train_config_FIX_A.yaml)
2. –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –Ω–∞ train_01.jpg (–ø–æ–Ω–∏–º–∞—è —á—Ç–æ —ç—Ç–æ –Ω–µ –ø–æ–∫–∞–∑–∞—Ç–µ–ª—å)
3. –í–∏–∑—É–∞–ª—å–Ω–æ –æ—Ü–µ–Ω–∏—Ç—å results/train_prediction.jpg

**–ü–û–¢–û–ú (–ø—Ä–∞–≤–∏–ª—å–Ω–æ):**
1. –°–æ–∑–¥–∞—Ç—å crops (–≤–∞—Ä–∏–∞–Ω—Ç B)
2. –†–∞–∑–¥–µ–ª–∏—Ç—å train/val
3. –°–æ–±—Ä–∞—Ç—å –±–æ–ª—å—à–µ –¥–∞–Ω–Ω—ã—Ö (–≤–∞—Ä–∏–∞–Ω—Ç C)
4. –†–∞–∑–º–µ—Ç–∏—Ç—å test –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è

**–ù–∞—á–Ω–∏—Ç–µ —Å FIX A - —ç—Ç–æ –∑–∞–π–º—ë—Ç 3-5 –º–∏–Ω—É—Ç!**
